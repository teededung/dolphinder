---
import MainLayout from "../../components/MainLayout.astro";
import LoginForm from "../../components/shared/LoginForm";
import { createSupabaseServerClient } from "../../lib/supabase/serverClient";
import { getCurrentUser } from "../../lib/auth";

export const prerender = false;

// Check if already logged in
const supabase = createSupabaseServerClient(Astro.cookies as any);
const user = await getCurrentUser(supabase);

if (user) {
  return Astro.redirect("/admin/dashboard");
}
---

<MainLayout title="Admin Login">
  <div class="min-h-screen pt-20">
    <div class="container mx-auto px-4 py-8">
      <div class="mx-auto max-w-md">
        <div class="bg-card rounded-lg border p-8 shadow-lg">
          <h1 class="mb-6 text-center text-3xl font-bold">Admin Login</h1>
          <LoginForm client:load />
        </div>
      </div>
    </div>
  </div>
</MainLayout>
